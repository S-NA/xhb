Only in working/Graphics/XHB/Gen/Input: Types.hi
Only in working/Graphics/XHB/Gen/Input: Types.o
Only in working/Graphics/XHB/Gen: Input.hi
Only in working/Graphics/XHB/Gen: Input.o
Only in working/Graphics/XHB/Gen/RandR: Types.hi
diff -u -r generated/1.2/Graphics/XHB/Gen/RandR/Types.hs working/Graphics/XHB/Gen/RandR/Types.hs
--- generated/1.2/Graphics/XHB/Gen/RandR/Types.hs	2008-12-13 00:49:50.000000000 -0600
+++ working/Graphics/XHB/Gen/RandR/Types.hs	2008-12-13 00:51:05.000000000 -0600
@@ -1143,11 +1143,11 @@
                     mwidth
                     mheight)
  
-data Notify = NotifyCrtcChange
-            | NotifyOutputChange
-            | NotifyOutputProperty
+data NotifyEnum = NotifyCrtcChange
+                | NotifyOutputChange
+                | NotifyOutputProperty
  
-instance SimpleEnum Notify where
+instance SimpleEnum NotifyEnum where
         toValue NotifyCrtcChange{} = 0
         toValue NotifyOutputChange{} = 1
         toValue NotifyOutputProperty{} = 2
@@ -1281,6 +1281,30 @@
                skip 11
                return (MkOutputProperty window output atom timestamp status)
  
+data NotifyData = NotifyDataCrtcChange CrtcChange
+                | NotifyDataOutputChange OutputChange
+                | NotifyDataOutputProperty OutputProperty
+     deriving (Show, Typeable)
+
+instance Serialize NotifyData where
+    serialize bo (NotifyDataCrtcChange x) = serialize bo x
+    serialize bo (NotifyDataOutputChange x) = serialize bo x
+    serialize bo (NotifyDataOutputProperty x) = serialize bo x
+
+    size (NotifyDataCrtcChange x) = size x
+    size (NotifyDataOutputChange x) = size x
+    size (NotifyDataOutputProperty x) = size x
+
+deserializeNotifyData :: NotifyEnum -> BO -> Get NotifyData
+deserializeNotifyData NotifyCrtcChange bo = NotifyDataCrtcChange `liftM` deserialize bo
+deserializeNotifyData NotifyOutputChange bo = NotifyDataOutputChange `liftM` deserialize bo
+deserializeNotifyData NotifyOutputProperty bo = NotifyDataOutputProperty `liftM` deserialize bo
+
+subCodeToNotifyEnum :: CARD8 -> NotifyEnum
+subCodeToNotifyEnum 0 = NotifyCrtcChange
+subCodeToNotifyEnum 1 = NotifyOutputChange
+subCodeToNotifyEnum 2 = NotifyOutputProperty
+
 data Notify = MkNotify{subCode_Notify :: CARD8,
                        u_Notify :: NotifyData}
             deriving (Show, Typeable)
@@ -1292,5 +1316,5 @@
           = do skip 1
                subCode <- deserialize bo
                skip 2
-               u <- deserialize bo
+               u <- deserializeNotifyData (subCodeToNotifyEnum subCode) bo
                return (MkNotify subCode u)
\ No newline at end of file
Only in working/Graphics/XHB/Gen/RandR: Types.o
Only in working/Graphics/XHB/Gen: RandR.hi
Only in working/Graphics/XHB/Gen: RandR.o
Only in working/Graphics/XHB/Gen/Record: Types.hi
Only in working/Graphics/XHB/Gen/Record: Types.o
Only in working/Graphics/XHB/Gen: Record.hi
Only in working/Graphics/XHB/Gen: Record.o
Only in working/Graphics/XHB/Gen/Render: Types.hi
Only in working/Graphics/XHB/Gen/Render: Types.o
Only in working/Graphics/XHB/Gen: Render.hi
Only in working/Graphics/XHB/Gen: Render.o
Only in working/Graphics/XHB/Gen/Res: Types.hi
Only in working/Graphics/XHB/Gen/Res: Types.o
Only in working/Graphics/XHB/Gen: Res.hi
Only in working/Graphics/XHB/Gen: Res.o
Only in working/Graphics/XHB/Gen/SELinux: Types.hi
Only in working/Graphics/XHB/Gen/SELinux: Types.o
Only in working/Graphics/XHB/Gen: SELinux.hi
Only in working/Graphics/XHB/Gen: SELinux.o
Only in working/Graphics/XHB/Gen/ScreenSaver: Types.hi
Only in working/Graphics/XHB/Gen/ScreenSaver: Types.o
Only in working/Graphics/XHB/Gen: ScreenSaver.hi
Only in working/Graphics/XHB/Gen: ScreenSaver.o
Only in working/Graphics/XHB/Gen/Shape: Types.hi
Only in working/Graphics/XHB/Gen/Shape: Types.o
Only in working/Graphics/XHB/Gen: Shape.hi
Only in working/Graphics/XHB/Gen: Shape.o
Only in working/Graphics/XHB/Gen/Shm: Types.hi
Only in working/Graphics/XHB/Gen/Shm: Types.o
Only in working/Graphics/XHB/Gen: Shm.hi
Only in working/Graphics/XHB/Gen: Shm.o
Only in working/Graphics/XHB/Gen/Sync: Types.hi
Only in working/Graphics/XHB/Gen/Sync: Types.o
Only in working/Graphics/XHB/Gen: Sync.hi
Only in working/Graphics/XHB/Gen: Sync.o
Only in working/Graphics/XHB/Gen/Test: Types.hi
Only in working/Graphics/XHB/Gen/Test: Types.o
Only in working/Graphics/XHB/Gen: Test.hi
Only in working/Graphics/XHB/Gen: Test.o
Only in working/Graphics/XHB/Gen/XCMisc: Types.hi
Only in working/Graphics/XHB/Gen/XCMisc: Types.o
Only in working/Graphics/XHB/Gen: XCMisc.hi
Only in working/Graphics/XHB/Gen: XCMisc.o
Only in working/Graphics/XHB/Gen/XF86Dri: Types.hi
Only in working/Graphics/XHB/Gen/XF86Dri: Types.o
Only in working/Graphics/XHB/Gen: XF86Dri.hi
Only in working/Graphics/XHB/Gen: XF86Dri.o
Only in working/Graphics/XHB/Gen/XFixes: Types.hi
diff -u -r generated/1.2/Graphics/XHB/Gen/XFixes/Types.hs working/Graphics/XHB/Gen/XFixes/Types.hs
--- generated/1.2/Graphics/XHB/Gen/XFixes/Types.hs	2008-12-13 00:49:50.000000000 -0600
+++ working/Graphics/XHB/Gen/XFixes/Types.hs	2008-12-13 00:49:51.000000000 -0600
@@ -3,7 +3,7 @@
         QueryVersionReply(..), SaveSetMode(..), SaveSetTarget(..),
         SaveSetMapping(..), ChangeSaveSet(..), SelectionEvent(..),
         SelectionEventMask(..), SelectionNotify(..),
-        SelectSelectionInput(..), CursorNotify(..), CursorNotifyMask(..),
+        SelectSelectionInput(..), CursorNotifyEnum(..), CursorNotifyMask(..),
         CursorNotify(..), SelectCursorInput(..), GetCursorImage(..),
         GetCursorImageReply(..), REGION, CreateRegion(..),
         CreateRegionFromBitmap(..), CreateRegionFromWindow(..),
@@ -208,9 +208,9 @@
                serialize bo (event_mask_SelectSelectionInput x)
                putSkip (requiredPadding size__)
  
-data CursorNotify = CursorNotifyDisplayCursor
+data CursorNotifyEnum = CursorNotifyDisplayCursor
  
-instance SimpleEnum CursorNotify where
+instance SimpleEnum CursorNotifyEnum where
         toValue CursorNotifyDisplayCursor{} = 0
         fromValue 0 = CursorNotifyDisplayCursor
  
Only in working/Graphics/XHB/Gen/XFixes: Types.o
Only in working/Graphics/XHB/Gen: XFixes.hi
Only in working/Graphics/XHB/Gen: XFixes.o
Only in working/Graphics/XHB/Gen/XPrint: Types.hi
Only in working/Graphics/XHB/Gen/XPrint: Types.o
Only in working/Graphics/XHB/Gen: XPrint.hi
Only in working/Graphics/XHB/Gen: XPrint.o
Only in working/Graphics/XHB/Gen/Xevie: Types.hi
Only in working/Graphics/XHB/Gen/Xevie: Types.o
Only in working/Graphics/XHB/Gen: Xevie.hi
Only in working/Graphics/XHB/Gen: Xevie.o
Only in working/Graphics/XHB/Gen/Xinerama: Types.hi
Only in working/Graphics/XHB/Gen/Xinerama: Types.o
Only in working/Graphics/XHB/Gen: Xinerama.hi
Only in working/Graphics/XHB/Gen: Xinerama.o
Only in working/Graphics/XHB/Gen/Xproto: Types.hi
diff -u -r generated/1.2/Graphics/XHB/Gen/Xproto/Types.hs working/Graphics/XHB/Gen/Xproto/Types.hs
--- generated/1.2/Graphics/XHB/Gen/Xproto/Types.hs	2008-12-13 00:49:50.000000000 -0600
+++ working/Graphics/XHB/Gen/Xproto/Types.hs	2008-12-13 00:49:51.000000000 -0600
@@ -548,6 +548,7 @@
                serialize bo (protocol_minor_version_SetupRequest x)
                serialize bo (authorization_protocol_name_len_SetupRequest x)
                serialize bo (authorization_protocol_data_len_SetupRequest x)
+               putSkip 2
                serializeList bo (authorization_protocol_name_SetupRequest x)
                serializeList bo (authorization_protocol_data_SetupRequest x)
         size x
@@ -556,6 +557,7 @@
               + size (protocol_minor_version_SetupRequest x)
               + size (authorization_protocol_name_len_SetupRequest x)
               + size (authorization_protocol_data_len_SetupRequest x)
+              + 2
               + sum (map size (authorization_protocol_name_SetupRequest x))
               + sum (map size (authorization_protocol_data_SetupRequest x))
  
@@ -567,6 +569,7 @@
                protocol_minor_version <- deserialize bo
                authorization_protocol_name_len <- deserialize bo
                authorization_protocol_data_len <- deserialize bo
+               skip 2
                authorization_protocol_name <- deserializeList bo
                                                 (fromIntegral authorization_protocol_name_len)
                authorization_protocol_data <- deserializeList bo
@@ -1317,6 +1320,51 @@
                                        y_ReparentNotify :: INT16,
                                        override_redirect_ReparentNotify :: BOOL}
                     deriving (Show, Typeable)
+
+ 
+data ClientMessageData = ClientData8  [CARD8]  -- ^length 20
+                       | ClientData16 [CARD16] -- ^length 10
+                       | ClientData32 [CARD32] -- ^length 5
+                   deriving (Show, Typeable)
+
+ 
+data ClientMessageDataType = CDType8
+                           | CDType16
+                           | CDType32
+ 
+clientMessageDataType :: ClientMessageData -> ClientMessageDataType
+clientMessageDataType ClientData8{}  = CDType8
+clientMessageDataType ClientData16{} = CDType16
+clientMessageDataType ClientData32{} = CDType32
+ 
+instance Serialize ClientMessageData where
+    serialize bo (ClientData8 xs) = assert (length xs == 20) $
+                                    serializeList bo xs
+    serialize bo (ClientData16 xs) = assert (length xs == 10) $
+                                     serializeList bo xs
+    serialize bo (ClientData32 xs) = assert (length xs == 5) $
+                                     serializeList bo xs
+    size cd = assert
+         (case cd of
+            ClientData8  xs -> length xs == 20
+            ClientData16 xs -> length xs == 10
+            ClientData32 xs -> length xs == 5)
+         20
+
+deserializeClientData :: BO -> ClientMessageDataType -> Get ClientMessageData
+deserializeClientData bo CDType8
+    = ClientData8 `liftM` deserializeList bo 20
+deserializeClientData bo CDType16
+    = ClientData16 `liftM` deserializeList bo 10
+deserializeClientData bo CDType32
+    = ClientData32 `liftM` deserializeList bo 5
+ 
+clientDataFormatToType :: CARD8 -> ClientMessageDataType
+clientDataFormatToType 8 = CDType8
+clientDataFormatToType 16 = CDType16
+clientDataFormatToType 32 = CDType32
+clientDataFormatToType _ = CDType8 -- should we throw an error here?
+
  
 instance Graphics.XHB.Shared.Event ReparentNotify
  
@@ -1617,7 +1665,7 @@
                skip 2
                window <- deserialize bo
                type_ <- deserialize bo
-               data_ <- deserialize bo
+               data_ <- deserializeClientData bo (clientDataFormatToType format)
                return (MkClientMessage format window type_ data_)
  
 data Mapping = MappingModifier
@@ -3555,6 +3603,9 @@
 odd_length_QueryTextExtents :: QueryTextExtents -> BOOL
 odd_length_QueryTextExtents x
   = (fromIntegral (string_len_QueryTextExtents x .&. 1))
+
+string_len_QueryTextExtents :: QueryTextExtents -> Word8
+string_len_QueryTextExtents x = genericLength $ string_QueryTextExtents x
  
 instance Serialize QueryTextExtents where
         serialize bo x
@@ -5302,10 +5353,11 @@
                putSkip 1
                serialize bo (convertBytesToRequestSize (size x) :: INT16)
                serialize bo (name_len_QueryExtension x)
+               putSkip 2
                serializeList bo (name_QueryExtension x)
                putSkip (requiredPadding (size x))
         size x
-          = 3 + 1 + size (name_len_QueryExtension x) +
+          = 3 + 1 + size (name_len_QueryExtension x) + 2 +
               sum (map size (name_QueryExtension x))
  
 data QueryExtensionReply = MkQueryExtensionReply{present_QueryExtensionReply
Only in working/Graphics/XHB/Gen/Xproto: Types.o
Only in working/Graphics/XHB/Gen: Xproto.hi
Only in working/Graphics/XHB/Gen: Xproto.o
Only in working/Graphics/XHB/Gen/Xv: Types.hi
diff -u -r generated/1.2/Graphics/XHB/Gen/Xv/Types.hs working/Graphics/XHB/Gen/Xv/Types.hs
--- generated/1.2/Graphics/XHB/Gen/Xv/Types.hs	2008-12-13 00:49:51.000000000 -0600
+++ working/Graphics/XHB/Gen/Xv/Types.hs	2008-12-13 00:49:51.000000000 -0600
@@ -15,6 +15,7 @@
         ListImageFormatsReply(..), QueryImageAttributes(..),
         QueryImageAttributesReply(..), PutImage(..), ShmPutImage(..))
        where
+import Prelude hiding (Rational)
 import Data.Word
 import Foreign.C.Types
 import Data.Bits
Only in working/Graphics/XHB/Gen/Xv: Types.o
Only in working/Graphics/XHB/Gen: Xv.hi
Only in working/Graphics/XHB/Gen: Xv.o
Only in working/Graphics/XHB/Gen/XvMC: Types.hi
Only in working/Graphics/XHB/Gen/XvMC: Types.o
